@model BiblocateAdminPanel.Models.RoomModel

@{
    Layout = "../Shared/_Layout.cshtml";
    ViewBag.Title = "Room " + @Model.Id;
}

<div style="height:750px; position: relative">

    <h2>Shelf intervals</h2>

    <button id="changeButton">Change Interval</button>
    <button onclick="@("window.location.href='" + @Url.Action("Edit/"+@Model.Id, "Room") + "'");">Edit room layout</button>

    <script>
        var shelfId;
        $(document).ready(function () {
            $(document).on("click", ".shelf", function () {
                if (shelfId !== $(this).attr("id")) {
                    $("#" + shelfId).css("filter", "hue-rotate(360deg)");
                    shelfId = $(this).attr("id");
                    $(this).css("filter", "hue-rotate(180deg)");
                }
            });
            $("#changeButton").on("click", function () {
                if (shelfId != null) {

                    $.get("/Room/EditInterval", { id: shelfId }, function (data, status) {
                        if (status === "success") {
                            $("#Id").attr("value", shelfId);
                            $("#a1").attr("value", data.a1);
                            $("#a2").attr("value", data.a2);
                            $("#b1").attr("value", data.b1);
                            $("#b2").attr("value", data.b2);
                        }
                    });
                    
                    editToggle();
                }
            });
        });
        function editToggle() {
            $(".popupEdit").toggle();
            $(".popupBack").toggle();
        }
    </script>

    <style>
        .imageDiv {
            position: relative;
            transform-origin: top left;
            transform: scale(0.5);
            padding-top: 10px;
        }

        .popupEdit table tr, .popupAdd table tr {
            height: 48px;
        }

        .popupEdit {
            position: absolute;
            top: 350px;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 500px;
            height: 520px;
            text-align: center;
            background-color: #a5a5a5;
            box-sizing: border-box;
            padding: 10px;
            z-index: 100;
            display: none;
            border-radius: 10px;
        }

        .popupBack {
            position: absolute;
            transform: scale(1.5);
            width: 100%;
            height: 100%;
            text-align: center;
            background: rgba(0,0,0,0.7);
            box-sizing: border-box;
            padding: 10px;
            z-index: 99;
            display: none;
            filter: blur(2px);
        }
    </style>


    <div class="popupBack"></div>

    <div class="popupEdit">
        <h1 style="margin-top:10px; color:white;">Edit shelf interval</h1>
        @using (Html.BeginForm())
        {
            @Html.AntiForgeryToken()
            <table class="popupEditTable" style="width:280px; margin-top:10px; font-size: 11px;" align="center">
                <tr>
                    <td>
                        <strong>
                            <input class="form_txt" id="Id" name="Id" hidden>
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>
                            <label for="a1" class="txt_label">a1</label>
                            <input class="form_txt" id="a1" name="a1">
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>
                            <label for="a2" class="txt_label">a2</label>
                            <input class="form_txt" id="a2" name="a2">
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>
                            <label for="b1" class="txt_label">b1</label>
                            <input class="form_txt" id="b1" name="b1">
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>
                            <label for="b2" class="txt_label">b2</label>
                            <input class="form_txt" id="b2" name="b2">
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td>
                        <table style="width:100%; margin-top:15px">
                            <tr>
                                <td style="width:50%; padding-left:50px"><a class="btn btn-default" onclick="editToggle();">Close</a></td>
                                <td style="padding-right:50px;" align="right"><button class="btn btn-warning" type="submit">Submit</button></td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        }
    </div>

    <div class="imageDiv">
        <img src="/Content/@(Model.Id).jpg" />
        @foreach (var item in Model.Shelves)
        {
            <img class="shelf" id="@(item.Id)" src="/Content/raf2.jpg" style="position:absolute; top:@(item.Y)px; left:@(item.X)px;" />
        }
    </div>


</div>
